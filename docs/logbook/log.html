<!DOCTYPE html>
<html>
<head>
	<title>Zed Dev Log</title>
	<link rel="icon" href="../../src/ide/icon.png">
	<style>
		@font-face {
			font-family: Cascadia;
			src: url("./CascadiaMono.ttf");
		}
		body {
			margin: 0 auto 50px auto;
			max-width: 800px;
			border: 3px solid black;
			padding: 10px;
		}
		body > h1 {
			text-align: center;
			font-family: Cascadia;
			font-size: 40px;
		}
		article {
			font-size: 14px;
			font-family: Cascadia;
			text-align: justify;
		}
		article > h1 {
			font-size: 30px;
			font-family: Cascadia;
			font-weight: bold;
			font-style: italic;
			margin-bottom: 10px;
		}
		article > h2 {
			margin: 10px 0 0 10px;
			font-size: 20px;
			font-family: Cascadia;
			font-style: italic;
		}
		img {
			display: block;
			margin: 5px auto;
			width: 90%;
			max-height: 500px;
			object-fit: contain;
		}
	</style>
</head>
<body>
	<h1>- The Z Programming Language -<br>Development Log 2020</h1>
	<article>
		<h1>T1W10</h1>
		<p>
			In-line with the <em>Project Plan</em>, the development
			evironment was installed. This included installing the
			Deno runtime, and setting up the environment for working
			with the Visual Studio Code IDE. The primary image required,
			the 'Z' logo, was designed.
		</p>
		<img src="../../src/ide/logo.png">
	</article>
	<article>
		<h1>T1W11</h1>
		<h2>11/12th April</h2>
		<p>
			To meet the T1W11 plan, the lexer, syntax-checker, and debugging
			messages were developed. These were developed as separate modules
			which in hind-sight probably slowed the implementation of the 
			algorithms, due to module-importing complexities.<br>
			By the end of the two days, the compiler could:
			<ul>
				<li>read a source file,</li>
				<li>generate an ordered list of language tokens,</li>
				<li>and generate a syntax tree based only on the
					<code>PROG ENDPROG</code> and 'assignment' structures.</li>
			</ul>
			The Lexing was achieved using regular expressions, which tested
			each word input and returned a category (keyword, number, etc.).
		</p>
	</article>
	<article>
		<h1>Hol.W1</h1>
		<h2>13th April</h2>
		<p>
			Today was spent attempting to create a special Syntax-Checker
			that could accept a list of rules and test given data. This
			was an interesting endeavour, however it proved fruitless due
			to difficulties managing recursion. It may be picked up during
			the later stages of development to make the code more flexible
			and easier to understand.<br>
			Part of the setback was due to complexities of JavaScript's
			function parameters. It is easy to forget that an Array
			being passed in is passed as a reference; this means that a 
			change to it in an external function (such as one called to
			recurse) will change its contents back outside, causing headaches
			when trying to figure out where something went wrong. This is
			solved by print the value of the Object when it is passed in, 
			and when that called function returns.
		</p>
		<h2>14th April</h2>
		<p>
			Today focused on implementing more syntax checks. This included
			parsing Input Statements, Conditions (which required recursion),
			Do Blocks, Pre-Tests and Output Statements. It also threw certain
			errors depending on where an invalid token was encountered. Each
			parser for a structure type was called, "popping" each token
			off of the Token-Array. If it threw a ParserError, the mistake
			was "mine" for calling it and so the Syntax-Checker attempted
			to parse the tokens with another parser. If a SyntaxError was
			discovered, the token was discarded and this meant that the user
			input was invalid, i.e. a malformed statement was provided.<br>
			At the end of the day, the program could reliably provide a
			Syntax Tree for more of Z's features.
		</p>
		<h2>15th April</h2>
		<p>
			Today focused on finishing the Syntax-Checker, and implementing
			the compiler to Python. An error was found in the syntax-checker
			regarding scopes. Some keywords end a scope, while others end a
			structure. A distinction was made and this solved an issue whereby
			the end of the program was reached because too many scopes were
			exited, thus leading to the end of the input by exiting the PROG
			scope.<br>
			The compiler included special functions for converting input from
			the user to numbers or strings depending on the input data. This
			was achieved by including a Python function in the outputed code.<br>
			As a test of the compiler, a fizzbuzz program was successfully
			written.
		</p>
		<img src="log-fizzbuzz.png">
		<h2>16th April</h2>
		<p>
			Today focused on polishing the compiler some more. The Python
			program was supplemented with another function, allowing
			variables of different types to be cast and used in assignment
			statements. This meant casting the value to be assigned to the
			data type of the variable to hold the value. This means that if
			<code>A1</code> holds the value <code>Hi</code>, then
			<code>= A1 2 +</code> will result in <code>A1</code> having the
			value <code>Hi2</code>.<br>
			To further test the compiler, Modulo, Fibonnaci and Squares
			programs were written and compiled and run successfully.
		</p>
		<img src="log-modulo.png">
		<img src="log-fibonacci.png">
		<img src="log-squares.png">
	</article>
	<article>
		<h1>Hol.W2</h1>
		<p>
			Work has been delayed by a week, but this is works with the
			Project Plan which allows for extra buffering should delays
			be encountered in development.
		</p>
	</article>
	<article>
		<h1>T2W1</h1>
		<h2>28th April</h2>
		<p>
			Begin the process of cleaning up folder structure, and think
			about a pre-compile stage to filter lexical tokens.
		</p>
		<h2>1st May 2020</h2>
		<p>
			Convert to an Object based approach for parsing.
			<br>
			I re-wrote the parser and lexer, to be cleaner. Internal documentation is still lacking.<br>
			It runs surprisingly quick, almost instantaneously!
		</p>
		<h2>3rd May 2020</h2>
		<p>
			GUI in place, with File, Edit, Help buttons and menus visible but not functional.<br>
			The editor also supports syntax highlighting.<br>
			<img src="log-2020-05-03-editor.png" width="400">
		</p>
		<h2>4th May 2020</h2>
		<p>
			Minor tweaks to formatting page.
		</p>
	</article>
	<article>
		<h1>T2W3</h1>
		<h2>13th May 2020</h2>
		<img src="log-2020-05-13-testcode.png">
		<h3>Error: Not parsing end of statement correctly.</h3>
		<img src="log-2020-05-13-testerror.png"><br>
		<img src="log-2020-05-13-testdebug.png"><br>
		<img src="log-2020-05-13-testfix.png">
		<p>
			Accidentally commented a line that removed the closing "]" for OUTPUT statement.
		</p>
		<h3>Error: Missing end of statement throws compilation.</h3>
		<img src="log-2020-05-13-test2error.png">
		<p>
			Turns out that t.shift() was removing the token on error,
			and not allowing a recovery. Replaced with t[0].
		</p>
		<img src="log-2020-05-13-test2fix.png">
		<p>
			Considering re-doing to the parser again to present a clearer logic,
			and push errors to a list, rather than throw (and have to deal with messy try-catch blocks)
		</p>
	</article>
	<article>
		<h1>T2W4</h1>
		<h2>22nd May 2020</h2>
		<p>
			After reviewing Web technologies, the "New" option
			is not needed in the "File" editor menu. A HTML input
			can be used to both open a file, and the native dialog
			also allows creating a new file.<br>
			The "Info" option is also seeming to be unnecessary, and so
			too will be removed.<br>
			The "Cut", "Copy", "Paste" menus are nice, but can be completed
			by the user using Right-Click and are thus unncessary. Thus, 
			"settings" will be moved to the "File" menu, and the "Edit" menu
			removed.
		</p>
	</article>
	<article>
		<h1>T2W5</h1>
		<h2>27th May 2020</h2>
		<p>
			The Web Editor is now capable of send a script to be run on the server.
			Next to be implemented is WebSockets between the browser and server.
		</p>
	</article>
	<article>
		<h1>T2W6</h1>
		<h2>3rd June 2020</h2>
		<p>
			The WebSocket interface works at a basic level. A script can be compiled
			from user input on the editor, and run, accepting input and displaying output,
			in the program execution screen.
		</p>
		<img src="./log-2020-06-02-samplecode.png">
		<img src="./log-2020-06-02-sampleoutput.png">
		<h2>5th June 2020</h2>
		<p>
			Going through each part of compiler for refactor. Lexer improved/simplified.
		</p>
		<h2>6th June 2020</h2>
		<p>
			<a href="https://www.freecodecamp.org/news/the-programming-language-pipeline-91d3f449c919/">Reading up on compiler</a>.
			Refactor In/Out, Assignment, Condition Code, simplification and following the single fail per statement rule.<br>
			Implementing Unit-Tests to test Zed Compiler without needing to compile a script. This was extremely valuable.
		</p>
	</article>
	<article>
		<h1>T2W7</h1>
		<h2>13th June 2020</h2>
		<p>
			Research was done to better understand the intricacies of a compiler, and to understand the different phases. This was very valuable to beginning the re-write.
			<a href="https://www.tutorialspoint.com/compiler_design/compiler_design_error_recovery.htm">How a compiler recovers.</a>
		</p>
	</article>
	<article>
		<h1>T2W8</h1>
		<h2>15th June 2020</h2>
		<p>
			Refactoring Parser, enabling code to be cleaner and easier to read. Remove duplication of parsing string/number/variable.<br>
			The follow were of great help in including file functionality into the editor.
			https://stackoverflow.com/questions/3582671/how-to-open-a-local-disk-file-with-javascript
			https://stackoverflow.com/questions/13405129/javascript-create-and-save-file
		</p>
		<h2>20th June 2020</h2>
		<p>
			Work was done on the usability of the editor, the Zed Programming Language manual was written,
			code comments were modified to become clearer in` the compiler source code and they were also added as a feature in Zed.
			Host.ts and Zed-Edit.js were created to further modularise code being used.
		</p>
	</article>
	<article>
		<h1>T2W9</h1>
		<h2>22nd June 2020</h2>
		<p>
			A bug was encountered whereby a SWITCH WHEN was allowing values between the WHEN blocks that should
			have been labelled as errors.
		</p>
		<img src="log-2020-06-22-switch_error.png">
		<p>
			Looking at the tokens list, it is expected that the output should follow the pattern of keyword, string, keyword, string ...<br>
			But looking at the output below, it is clear that the "21" is not following a keyword. So something must be wrong.
		</p>
		<img src="log-2020-06-22-switch_error_tokens_listed.png">
		<p>
			Upon looking at the code, it was a messy while statement, that had logic all over the place.
			The main issue was the skipToNextWhen to next when which was interacting unexpectedly with the condition in the javascript while loop. 
			The fix was to simplify the loop logic, and keep any break conditions inside.
		</p>
		<img src="log-2020-06-22-switch_old_code.png">
		<p>
			The new code is visually much easier to follow, and it is clear what drives the decisions the parser makes.
		</p>
		<img src="log-2020-06-22-switch_new_code.png">
		<p>
			The correctly shown error, as a result of the fix, is below.
		</p>
		<img src="log-2020-06-22-switch_fixed.png">
		<h2>Completion!</h2>
		<p>
			The project is now complete, and a documentation of the Zed Language and editor is provided in the manual,
			"The Zed Programming Language".
		</p>
	</article>
</body>
</html>